// ------------------------------
// Configuración y Variables
// ------------------------------

.avatar {
  --#{$prefix}avatar-size: 3rem;
  --#{$prefix}avatar-font-size: 1.25rem; // Tamaño del icono/texto
  --#{$prefix}avatar-color: var(--#{$prefix}body-color);
  --#{$prefix}avatar-bg: var(--#{$prefix}secondary-bg);
  --#{$prefix}avatar-border-radius: 50%;
  --#{$prefix}avatar-img-fit: cover;
  --#{$prefix}avatar-ring-color: var(--#{$prefix}body-bg);
}

// ------------------------------
// Mixins
// ------------------------------

@mixin avatar-size($size, $font-size) {
  --#{$prefix}avatar-size: #{$size};
  --#{$prefix}avatar-font-size: #{$font-size};
}

// ------------------------------
// Base Avatar
// ------------------------------

.avatar {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  position: relative;
  vertical-align: middle;

  width: var(--#{$prefix}avatar-size);
  height: var(--#{$prefix}avatar-size);

  // El font-size controla el tamaño de los iconos
  font-size: var(--#{$prefix}avatar-font-size);
  font-weight: 600;
  color: var(--#{$prefix}avatar-color);
  background-color: var(--#{$prefix}avatar-bg);

  border-radius: var(--#{$prefix}avatar-border-radius);

  // Sombra interna sutil
  box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.05);

  user-select: none;
  transition: all 0.2s ease-in-out;
  text-decoration: none; // Por si es un <a>

  // ------------------------------
  // Content & Icons Alignment
  // ------------------------------

  // 1. Imágenes
  img {
    width: 100%;
    height: 100%;
    object-fit: var(--#{$prefix}avatar-img-fit);
    border-radius: inherit;
    display: block;
  }

  // 2. Iconos Generales (FontAwesome, Bootstrap Icons, Feather)
  // La clave para el centrado es width/height: 1em y line-height: 1
  i,
  svg,
  span,
  .feather,
  [class^="bi-"],
  [class^="fa-"] {
    display: inline-flex;
    align-items: center;
    justify-content: center;

    width: 1em; // Ocupa exactamente el tamaño de la fuente definida
    height: 1em;
    line-height: 1; // Elimina espaciado vertical extra

    text-align: center;
    color: inherit;
  }

  // Ajuste específico para Feather Icons (suelen ser SVGs con stroke)
  .feather {
    stroke-width: 2px; // Un poco más grueso para mejor visibilidad
    width: var(--#{$prefix}avatar-font-size);
    height: var(--#{$prefix}avatar-font-size);
  }
}

// ------------------------------
// Shapes
// ------------------------------
.avatar-square {
  --#{$prefix}avatar-border-radius: 0;
}

.avatar-rounded {
  --#{$prefix}avatar-border-radius: var(--#{$prefix}border-radius);
}

// ------------------------------
// Sizes
// ------------------------------
.avatar-xs {
  @include avatar-size(1.5rem, 0.75rem);
}

.avatar-sm {
  @include avatar-size(2rem, 0.875rem);
}

.avatar-lg {
  @include avatar-size(4rem, 1.75rem);
}

.avatar-xl {
  @include avatar-size(5rem, 2.5rem);
}

// ------------------------------
// Status (Fixed Geometry)
// ------------------------------
.avatar-status {
  position: absolute;
  bottom: -5px;
  right: -5px;
  transform: translate(-15%, -15%); // Centra el punto en el borde del círculo

  width: 28%;
  height: 28%;
  min-width: 8px;
  min-height: 8px;

  border-radius: 50%;
  border: 2px solid var(--#{$prefix}avatar-ring-color);
  background-color: var(--#{$prefix}secondary);
  z-index: 5;
}

// ------------------------------
// Colors
// ------------------------------
@each $color, $value in $theme-colors {
  .avatar-#{$color} {
    --#{$prefix}avatar-bg: #{$value};
    --#{$prefix}avatar-color: #{color-contrast($value)};
  }
}

// ------------------------------
// Avatar Group
// ------------------------------
.avatar-group {
  display: inline-flex;
  flex-wrap: nowrap;

  .avatar {
    margin-right: -0.75rem;
    border: 2px solid var(--#{$prefix}avatar-ring-color);

    &:hover {
      z-index: 10;
      transform: translateY(-3px);
    }
  }
}

// ------------------------------
// Dark Mode
// ------------------------------
@if $enable-dark-mode {
  @include color-mode(dark) {
    .avatar {
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.1);

      &:not([class*="avatar-"]) {
        --#{$prefix}avatar-bg: var(--#{$prefix}tertiary-bg);
      }
    }
  }
}